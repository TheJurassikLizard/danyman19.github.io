<!DOCTYPE html>
<html>
  <head>
    <title>2020_FTT</title>
    <link rel="stylesheet" type="text/css" href="styles.css" media="screen"/>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
  </head>

  <body>
    <a href="intro.html"><button id = "intro_option" class = "option"><span>Intro</span></button></a>
    <a href="howtoplay.html"><button id = "howtoplay_option" class = "option"><span>How To Play</span></button></a>
    <a href="challenges.html"><button id = "challenges_option" class = "option"><span>Challenges</span></button></a>
    <a href="creators.html"><button id = "creators_option" class = "option"><span>Creators</span></button></a>
    <br><br>
    <h1 class="lines">Please enable JS.</h1>
    <h1 class = "header">CHALLENGES</h1>
    <h1 class="lines">Please enable JS.</h1>
    <div id="challenges"></div>

    <script>
      onresize = function(){
        for(var i = 0;i<document.getElementsByClassName("lines").length;i++){
          var el = document.getElementsByClassName("lines")[i];
          el.innerHTML = "";
          for(var j = 0;j<window.innerWidth/20;j++) el.innerHTML += "_";
        }

        //Only runs if inspect window is too big and left side is too small
        for(var i = 0;i<document.getElementsByClassName("option").length;i++){
          var el = document.getElementsByClassName("option")[i];
          el.style.display = window.innerWidth<500?"none":"block";
        }
      }

      onresize();
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>

    <!--We have an honesty policy out here
        It is to not reverse the ftts 
        with our public key.

        Please don't it defeates the purpose
        of doing the ctfs.

        You don't learn anything and it isn't fun.

        So don't.
    -->
    <script>
      var key = "";

      function reqListener () {
        key = this.responseText.split("=")[1];
      }

      var oReq = new XMLHttpRequest();
      oReq.addEventListener("load", reqListener);
      oReq.open("GET", "secretkey.txt");
      oReq.send();

      function encrypt(text,key){
        //32 -> 126
        var charcodes = [];
        for (var i = 0; i < text.length; i++) {
          charcodes.push(text.charCodeAt(i) - 32);
          if(charcodes[i]<0 || charcodes[i]>94){
            console.log("invalid input");
            return "ERROR!!";
          }
        }
        console.log(charcodes);
      }
      console.log(encrypt(" !\"#$&'()*abc","hu"));

      class Challenge{
        constructor(name,description,solution){
          this.name = name;
          this.description = description;
          this.solution = solution;

          this.container = document.createElement("div");
          this.container.className = "challengediv";
          this.container.innerHTML = `
            <h3 class= "header">`+this.name+`</h3>
            <p>`+this.description+`</p>
            <input type="text" class = "center" style="margin:0px auto; display:block;" placeholder="ftt{..}">
            <br>
            <button class = "center" style="margin:0px auto; display:block;">Submit</button>
          `;
          document.getElementById("challenges").appendChild(this.container);
        }
        addListener(){
          var container = this.container;
          var solution = this.solution;
          
          container.children[4].addEventListener("click",buttonPress);

          function buttonPress(){
            if(/*encrypt(*/container.children[2].value/*,key)*/==solution){
              alert("NICE!!");
            }
          }
        }

        doall(){
          this.addListener();
        }
      }
      var challenges = [new Challenge("Julius (Cryptography)","Julius left a <a href='txt_files/Julius.txt' target='_blank'>message</a>","testing123")];
      for(var i in challenges){
        challenges[i].doall();
      }
    </script>
  </body>

</html>